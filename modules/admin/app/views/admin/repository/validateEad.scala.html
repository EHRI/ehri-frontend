@(results: Map[String, Seq[services.ingest.EadValidator#Error]], item: Repository, f: play.api.data.Form[String], action: Call)(implicit userOpt: Option[UserProfile], req: RequestHeader, globalConfig: global.GlobalConfig, messages: Messages, md: views.MarkdownRenderer, prefs: utils.SessionPrefs, flash: Flash)

@implicitField = @{ views.html.helper.FieldConstructor(formHelpers.fieldTemplate.f) }

@views.html.admin.layout.rightSidebar(Messages("repository.data.validate"), breadcrumbs = views.html.admin.common.breadcrumbs(List(item))) {
    @if(results.nonEmpty) {
        <table id="validation-results" class="table table-bordered table-striped table-sm">
            <thead>
                <tr>
                    <td>@Messages("repository.data.validate.file.name")</td>
                    <td>@Messages("repository.data.validate.file.errors")</td>
                </tr>
            </thead>
            <tbody>
                @results.map { case (file, errs) =>
                    <tr>
                        <td>@file</td>
                        <td>
                            @if(errs.isEmpty) {
                                @Messages("repository.data.validate.okay")
                            } else {
                                <ul class="alert alert-danger">
                                    @errs.map { err =>
                                        <li>@(s"${err.line}/${err.pos} - ${err.error}")</li>
                                    }
                                </ul>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
        <hr>
    }
    <h3>@Messages("repository.data.validate.files")</h3>
    @helper.form(action = action, 'enctype -> "multipart/form-data") {
        @formHelpers.csrfToken()
        @formHelpers.globalErrors(f)

        @helper.inputFile(f("files"), '_label -> Messages("repository.data.validate.files"), 'multiple -> true)

        @formHelpers.submitButton(Messages("repository.data.validate.submit"))
    }
} {
}
