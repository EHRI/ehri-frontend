@(result: utils.search.ItemPage[(AnyModel, utils.search.SearchHit)], params: utils.search.SearchParams, action: Call, key: String = "portal.search", headerKey: String = "pagination.displayingItems", autofocus: Boolean = false)(html: Html)(facets: Html = Html(""))(implicit userOpt: Option[UserProfile], req: RequestHeader, globalConfig: global.GlobalConfig, lang: Lang, flash: Flash)

@import utils.search.{SearchParams,SearchOrder}

@p.layout.mainContent {
    @if(params.isFiltered || !result.items.isEmpty) {
        @helper.form(action = action, 'role -> "form") {

        @p.common.searchBar(params, autofocus = autofocus, placeholder = key)
        <div class="row">
            <div class="col-md-9">
                <h4>
                    @Messages(headerKey, result.offset + 1, result.offset + result.items.size, result.total)

                    @result.spellcheck.map { case (actual, corrected) =>
                    @defining(params.query.map(_.toLowerCase.replace(actual.toLowerCase, corrected))) { suggestion =>
                    (@Messages("search.spellingSuggestion")
                    <i>
                        <strong>
                            <a href="@utils.joinPath(req.path, req.queryString.updated(SearchParams.QUERY, suggestion.toSeq))">@suggestion</a>
                        </strong>
                    </i>?)
                    }
                    }
                </h4>

                <p>
                    @selectedFacets(result)
                </p>

                @html
                @helpers.pagination(result)
            </div>
            <div class="col-md-3 sidebar">
                @facets
            </div>
        </div>
        }
    }
}