@(replyTo: String, query: String, results: Seq[backend.HelpdeskDAO.HelpdeskResponse], institutions: Seq[Repository])(implicit userOpt: Option[UserProfile], request: RequestHeader, lang: Lang, flash: Flash, globalConfig: global.GlobalConfig, prefs: utils.SessionPrefs)

@p.layout.portalLayout(Messages("pages.helpdesk")) {

    @views.html.layout.mainContent {

        <h2>@Messages("pages.helpdesk.results")</h2>

        <div class="well well-sm">
            <strong>@Messages("pages.helpdesk.youAsked")</strong>: &quot;@query&quot;
        </div>

        <div class="panel panel-default">
            @if(results.nonEmpty) {
            <table class="table table-striped">
                <tr>
                    <th>@Messages("pages.helpdesk.institution")</th>
                    <th>@Messages("pages.helpdesk.score")</th>
                    <th>@Messages("pages.helpdesk.contactEmail")</th>
                </tr>
                @results.zip(institutions).map { case (result, repo) =>
                    <tr>
                        <td>@views.html.p.helpers.linkTo(repo)</td>
                        <td>
                            @result.score
                        </td>
                        <td>
                            @Html(repo.emails.map(e => s"<a href='mailto:$e?subject=EHRI Helpdesk Query&amp;body=${helper.urlEncode(query).replace("+", "%20")}&amp;reply-to=$replyTo'>$e</a>").mkString(", "))
                        </td>
                    </tr>
                }
            </table>
            } else {
            <p class="alert alert-warning">
                @Messages("pages.helpdesk.results.empty")
            </p>
            }
        </div>
    }
}