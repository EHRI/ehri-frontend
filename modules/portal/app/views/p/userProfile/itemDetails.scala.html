@(item: UserProfile, followed: Boolean, canMessage: Boolean)(content: Html)(implicit userOpt: Option[UserProfile], request: RequestHeader, prefs: utils.SessionPrefs, globalConfig: global.GlobalConfig, lang: Lang, flash: Flash)

@isCurrentUser = @{userOpt.exists(_.id == item.id)}

<div id="item-details">
    @p.layout.rightSidebar {
        @p.common.itemHeader(item.toStringLang) {
        }
        @details(item)

        @content
    } {

        @p.common.typeLabel(EntityType.UserProfile) {
            <ul class="list-group">
                <li class="list-group-item user-img">
                    <a href="@{if(isCurrentUser) controllers.portal.profile.routes.Profile.profile else controllers.portal.social.routes.Social.browseUser(item.id)}" class="gravitar">
                        <img class="user-img-full" src="@views.p.Helpers.gravitar(item.model.imageUrl)" alt="@item.model.name"/>
                    </a>
                </li>
                @if(isCurrentUser) {
                    <li class="list-group-item">
                        <a class="btn btn-get" href="@controllers.portal.profile.routes.Profile.updateProfile">
                            @Messages("portal.profile.edit")
                        </a>
                    </li>
                } else {
                    <li class="list-group-item btn-group-vertical" role="group">
                        @p.common.messageButtons(item, canMessage)
                        @p.common.followingButtons(item, followed)
                    </li>
                }
                <li class="list-group-item user-profile-social">
                    <a class="followers" href="@controllers.portal.social.routes.Social.followersForUser(item.id)">
                        @Messages("portal.social.followers"): <span class="user-follower-count">@item.followerCount</span>
                    </a>
                    <a class="following" href="@controllers.portal.social.routes.Social.followingForUser(item.id)">
                        @Messages("portal.social.following"): <span class="user-following-count">@item.followingCount</span>
                    </a>
                </li>
            </ul>
        }

        <div class="panel panel-default">
            <div class="panel-body">
                <ul class="nav list-group">
                    <li class="@views.Helpers.maybeActive(controllers.portal.social.routes.Social.browseUser(item.id).url)">
                        <a href="@controllers.portal.social.routes.Social.browseUser(item.id)">
                            <i class="glyphicon glyphicon-list"></i> @Messages("portal.activity")
                        </a>
                    </li>
                    <li class="@views.Helpers.maybeActive(controllers.portal.social.routes.Social.watchedByUser(item.id).url)">
                        <a href="@controllers.portal.social.routes.Social.watchedByUser(item.id)">
                            <span class="glyphicon glyphicon-star"></span>
                            @Messages("portal.profile.watch.list")
                        </a>
                    </li>
                    @if(userOpt.exists(_.id == item.id)) {
                        <li class="@views.Helpers.maybeActive(controllers.portal.profile.routes.Profile.profile.url)">
                            <a href="@controllers.portal.profile.routes.Profile.profile">
                                <span class="glyphicon glyphicon-edit"></span>
                                @Messages("portal.annotation.list")
                            </a>
                        </li>
                    }
                </ul>
            </div>
        </div>

        @p.common.latestAction(item, controllers.portal.routes.Portal.itemHistory(item.id, modal = true))
    }
</div>
