@(item: AnyModel, nodeId: String, value: Option[List[String]], key: String, transformFunc: (String => String) = { s => s})(implicit fieldPrefix: String, userOpt: Option[UserProfile], req: RequestHeader, prefs: utils.SessionPrefs, globalConfig: global.GlobalConfig, lang: Lang, fieldAnnotations: Seq[Annotation])

@value.map { list =>
	@defining(fieldAnnotations.filter(_.model.field==Some(key))) { anns =>
	    @if(!list.isEmpty) {
	        <div class="item-text-field" id="@nodeId-@key">
	            <h4 class="item-text-field-header">
	            	@Messages(if (fieldPrefix.isEmpty) key else "%s.%s".format(fieldPrefix, key))
	            </h4>
	            <div class="item-text-field-value">
			        <ul>
			            @list.map { item =>
			                <li>@transformFunc(item)</li>
			            }
			        </ul>
	            </div>
	            <div class="item-text-field-annotation-container">
	                <div class="item-text-field-annotations annotation-set">
	                    <h5 class="annotate-item-header">@Messages("portal.social.createFieldAnnotation")</h5>
	                    @p.common.inlineAnnotationList(anns)

	                    @if(userOpt.isDefined) {
	                        <div class="annotate-item-controls">
	                            <a title="@Messages("portal.social.createFieldAnnotation")" data-item="@item.id" data-did="@nodeId" data-field="@key" class="annotate-field inactive" href="@controllers.portal.routes.Portal.annotateField(item.id, nodeId, key)">
	                                <span class="glyphicon glyphicon-comment"></span>
	                            </a>
	                            @defining(anns.count(!_.isOwnedBy(userOpt))) { otherCount =>
	                                @if(otherCount > 0) {
	                                <a title="@Messages("portal.social.showPublicAnnotations", otherCount)" class="show-other-annotations" href="#">
	                                    <span class="glyphicon glyphicon-chevron-down"></span>
	                                    @otherCount
	                                </a>
	                                }
	                            }

	                        </div>
	                    }
	                </div>
	            </div>
	        </div>
	    }
	}
}