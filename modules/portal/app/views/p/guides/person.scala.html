@(template: (GuidePage, (Guide, List[GuidePage])), page: utils.search.ItemPage[(HistoricalAgent,utils.search.SearchHit)], params: utils.search.SearchParams)(implicit userOpt: Option[UserProfile], request: RequestHeader, prefs: utils.SessionPrefs, globalConfig: global.GlobalConfig, lang: Lang, flash: Flash)
@js = {
	<script type="text/javascript">
	$(document).ready(function() {
		$(".preview-closer").on("click", function(e) { e.preventDefault();
			$(this).parent().removeClass("in");
		});
		$(".item-to-preview").on("click", function(e) { e.preventDefault();
			dat = $(this);
			previewDiv = $("#person-preview");
			if(previewDiv.parent().css("display") === "none") {	
				dat.siblings(".item-description").toggleClass("in");
			} else {	
				dat.siblings(".item-description").removeClass("in");
				previewDiv.addClass("in");
				html = dat.siblings(".item-description").html();
				name = dat.siblings(".item-title").text();
				$("#person-preview .person-desc").html(html);
				$("#person-preview h2").text(name);
			}
		});
	});
	</script>
}

@p.layout.guideLayout(template, js) {
	<article>
		<header>
			<form role="form" action="@controllers.portal.routes.Guides.layoutRetrieval(template._2._1.path, template._1.path)">
				<ul class="nav nav-pills nav-ehri nav-ehri-black nav-justified">
					<li><input class="nav-ehri nav-ehri-black nav-ehri-input" name="q" placeholder="Name" /></li>
					<li><button type="submit" class="nav-ehri nav-ehri-black nav-ehri-input"><span class="glyphicon glyphicon-search"></span><span class="text-hide">Search</span></button></li>
				</ul>
			</form>
		</header>
		<section>
			<ul class="list-unstyled">
			    @page.items.map { case(item, hit) =>
			        @defining(Some(hit.id)) { implicit descriptionId =>
			            <li>

				    <div class="search-item" id="@item.id">
				            <h3 class="search-item-heading type-highlight @item.isA.toString">
				                <a href="@controllers.portal.routes.Guides.guideFacets(template._2._1.path)?kw[]=@item.id">@item.toStringLang</a>
				            </h3>
				            <div class="search-item-body">
				                
				            	@item match { 
				            		 case d: HistoricalAgent => {
				            		 	 @p.historicalAgent.listItemBody(d)
				            		}
				            		case _ => {

				            		}
					            }
				            </div>
				    </div>
			            </li>
			        }
			    }
			</ul>


		</section>
		<footer>
			@common.pagination(page)
		</footer>
	</article>

}