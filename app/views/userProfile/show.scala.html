@(item: UserProfileRepr, maybeUser: Option[models.sql.User], perms: Option[acl.ItemPermissionSet[_]], req: RequestHeader)

@import defines._

@main(item.name)(maybeUser, req) {
	
	<h3>User: @item.name (@item.identifier)</h3>
	
	@common.descriptionValue(Some(item.property("location").flatMap(_.asOpt[String]).getOrElse("No location information given")), "Location")
	@* @common.descriptionValue(if (item.languages.mkString(", ").isEmpty) None else Some(item.languages.mkString(", ")), "Languages") *@
	@* @common.descriptionValue(Some(item.about.getOrElse("No biographical information given")), "About") *@
	
	<hr />
	@if(item.groups.isEmpty) {
	  <i>This user does not belong to any groups.</i>	  
	} else {
	  <strong>Groups: </strong>&nbsp;
	  @item.groups.map { group =>
	    <a href="@routes.Groups.get(group.identifier)">@group.name</a>
	  }	  
	}
	
	@common.visibility(item)
	
  	<hr />
	<a href="@routes.UserProfiles.list(1, 20)">@Messages("Back to List")</a>	
	@maybeUser.map { user =>
	  @user.permissions.map { pset =>
	    @perms.map { iset =>
	  		@if(pset.has(ContentType.UserProfile, PermissionType.Create)) {
	  		  &nbsp;|&nbsp;
	  		  <a href="@routes.UserProfiles.create">@Messages("Create New User")</a>
	  		}
	  		@if(iset.has(PermissionType.Update) || pset.has(ContentType.UserProfile, PermissionType.Update)) {
	  		  &nbsp;|&nbsp;
	  		  <a href="@routes.UserProfiles.update(item.id)">@Messages("Modify Profile")</a>
	  		}
	  		@if(iset.has(PermissionType.Update) || pset.has(ContentType.UserProfile, PermissionType.Update)) {
	  		  &nbsp;|&nbsp;
	  		  <a href="@routes.UserProfiles.visibility(item.id)">@Messages("Set Visibility")</a>
	  		}  		
	  		@if(iset.has(PermissionType.Grant) || pset.has(ContentType.UserProfile, PermissionType.Grant)) {
	  		  &nbsp;|&nbsp;
	  		  <a href="@routes.UserProfiles.permissions(item.id)">@Messages("Modify Permissions")</a>
	  		}	      		
	  		@if(iset.has(PermissionType.Grant) || pset.has(ContentType.UserProfile, PermissionType.Grant)) {
	  		  &nbsp;|&nbsp;
	  		  <a href="@routes.Groups.membership(item.isA.toString, item.id)">@Messages("Add/Remove Parent Groups")</a>
	  		}	      		  		
	  		@if(iset.has(PermissionType.Delete) || pset.has(ContentType.UserProfile, PermissionType.Delete)) {
	  		  &nbsp;|&nbsp;
	  		  <a href="@routes.UserProfiles.delete(item.id)">@Messages("Delete User")</a>
	  		}	    	      
	    }
	  }
	}	
	
}