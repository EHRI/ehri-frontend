@(item: Option[Repository], f: Form[RepositoryF])(implicit userOpt: Option[UserProfile], req: RequestHeader, lang: Lang, flash: Flash)
@import models.base.DescribedEntity

@import Isdiah._

@implicitField = @{ views.html.helper.FieldConstructor(common.fieldTemplate.f) }

@defining("isdiah") { implicit fieldPrefix =>
        @helper.inputText(f("identifier"), '_label -> "Identifier")
        @helper.inputText(f("name"), '_label -> Messages(fieldPrefix + ".authorizedFormOfName"))

    @helper.repeat(f(DescribedEntity.DESCRIPTIONS), min=math.max(f(DescribedEntity.DESCRIPTIONS).indexes.length, 1)) { desc =>
        @formHelpers.choiceInput(desc(LANG_CODE), LANG_CODE, views.Helpers.languagePairList, blank=true)

        <fieldset id="identity-area">
            <legend>@Messages(fieldPrefix + "." + IDENTITY_AREA)</legend>
            @formHelpers.hiddenInput(desc(Entity.ID))

            @repository.renderInlineNameSet(desc, OTHER_FORMS_OF_NAME)
            @repository.renderInlineNameSet(desc, PARALLEL_FORMS_OF_NAME)

        </fieldset>

        <fieldset id="contact-area">
            <legend>@Messages(fieldPrefix + "." + ADDRESS_AREA)</legend>
            @helper.repeat(desc(ADDRESS_AREA), min=math.max(desc(ADDRESS_AREA).indexes.length, 1)) { desc =>
                @formHelpers.hiddenInput(desc(Entity.ID))
                @formHelpers.lineInput(desc, ADDRESS_NAME)
                @formHelpers.lineInput(desc, CONTACT_PERSON)
                @formHelpers.lineInput(desc, STREET_ADDRESS)
                @formHelpers.lineInput(desc, CITY)
                @formHelpers.lineInput(desc, REGION)
                @formHelpers.choiceInput(desc(COUNTRY_CODE), COUNTRY_CODE, views.Helpers.countryPairList, blank=true)
                @formHelpers.lineInput(desc, EMAIL)
                @formHelpers.lineInput(desc, TELEPHONE)
                @formHelpers.lineInput(desc, FAX)
                @formHelpers.lineInput(desc, URL)
            }
        </fieldset>

        <fieldset id="description-area">
            <legend>@Messages(fieldPrefix + "." + DESCRIPTION_AREA)</legend>
            @defining(desc(DESCRIPTION_AREA)) { desc =>
                @formHelpers.textInput(desc, HISTORY)
                @formHelpers.textInput(desc, GENERAL_CONTEXT)
                @formHelpers.textInput(desc, MANDATES)
                @formHelpers.textInput(desc, ADMINISTRATIVE_STRUCTURE)
                @formHelpers.textInput(desc, RECORDS)
                @formHelpers.textInput(desc, BUILDINGS)
                @formHelpers.textInput(desc, HOLDINGS)
                @formHelpers.textInput(desc, FINDING_AIDS)
            }
        </fieldset>

        <fieldset id="access-area">
            <legend>@Messages(fieldPrefix + "." + ACCESS_AREA)</legend>
            @defining(desc(ACCESS_AREA)) { desc =>
                @formHelpers.textInput(desc, OPENING_TIMES)
                @formHelpers.textInput(desc, CONDITIONS)
                @formHelpers.textInput(desc, ACCESSIBILITY)
            }
        </fieldset>

        <fieldset id="services-area">
            <legend>@Messages(fieldPrefix + "." + SERVICES_AREA)</legend>
            @defining(desc(SERVICES_AREA)) { desc =>
                @formHelpers.textInput(desc, RESEARCH_SERVICES)
                @formHelpers.textInput(desc, REPROD_SERVICES)
                @formHelpers.textInput(desc, PUBLIC_AREAS)
            }
        </fieldset>

        <fieldset id="control-area">
            <legend>@Messages(fieldPrefix + "." + CONTROL_AREA)</legend>
            @defining(desc(CONTROL_AREA)) { desc =>
                @formHelpers.lineInput(desc, DESCRIPTION_IDENTIFIER)
                @formHelpers.lineInput(desc, INSTITUTION_IDENTIFIER)
                @formHelpers.textInput(desc, RULES_CONVENTIONS)
                @formHelpers.textInput(desc, STATUS)
                @formHelpers.textInput(desc, LEVEL_OF_DETAIL)
                @formHelpers.textInput(desc, DATES_CVD)
                @formHelpers.multiselectInput(desc(LANGUAGES_USED), LANGUAGES_USED, views.Helpers.languagePairList)
                @formHelpers.multiselectInput(desc(SCRIPTS_USED), SCRIPTS_USED, views.Helpers.scriptPairList)
                @formHelpers.textInput(desc, SOURCES)
                @formHelpers.textInput(desc, MAINTENANCE_NOTES)
            }
        </fieldset>
    }
}