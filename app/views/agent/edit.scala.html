@(item: Option[AgentRepr], f: play.api.data.Form[Agent], action: Call, user: UserProfileRepr, req: RequestHeader)
 
@import models.Address._
@import models.Agent._

@implicitField = @{ views.html.helper.FieldConstructor(common.fieldTemplate.f) }

@main(item.map("Update " + _.name).getOrElse("Create item"))(Some(user), req) {
	
	@item.map { v =>
		<h3>Update @v.name</h3>
	}.getOrElse {
		<h3>Create</h3>
	}
		
	
	@helper.form(action = action, 'class -> "entity-form form-horizontal") {
		<fieldset id="identity-area">
			<legend>@Messages("Identity")</legend>
			@helper.inputText(f("identifier"), '_label -> "Identifier")
			@helper.inputText(f("name"), '_label -> "Name")
		</fieldset>
	  
		@helper.repeat(f("descriptions"), min=math.max(f("descriptions").indexes.length, 1)) { desc =>
			<fieldset id="identity-area">
				<legend>@Messages("Description")</legend>
				@helper.input(desc(Entity.ID)) { (id, name, value, args) =>
  					<input type="hidden" name="@name" value="@value" id="@id" @toHtmlArgs(args)>
				} 
				@helper.inputText(desc("languageCode"), '_label -> "Language Code")
				@helper.inputText(desc("name"), '_label -> "Authorized Form of Name")
				@helper.repeat(desc(OTHER_FORMS_OF_NAME), min = item.flatMap(_.listProperty(OTHER_FORMS_OF_NAME).map(_.length)).getOrElse(0) + 1) { onField =>
					@helper.inputText(onField)
				}
				@helper.repeat(desc(PARALLEL_FORMS_OF_NAME), min = item.flatMap(_.listProperty(PARALLEL_FORMS_OF_NAME).map(_.length)).getOrElse(0) + 1) { pnField =>
					@helper.inputText(pnField)
				}
			</fieldset>
			<fieldset id="contact-area">
				<legend>@Messages("Contact")</legend>
				@helper.repeat(desc("addresses"), min=math.max(desc("addresses").indexes.length, 1)) { desc =>
					@helper.input(desc(Entity.ID)) { (id, name, value, args) =>
	  					<input type="hidden" name="@name" value="@value" id="@id" @toHtmlArgs(args)>
					} 
					@formHelpers.lineInput(desc, ADDRESS_NAME)
					@formHelpers.lineInput(desc, CONTACT_PERSON)
					@formHelpers.lineInput(desc, STREET_ADDRESS)
					@formHelpers.lineInput(desc, CITY)
					@formHelpers.lineInput(desc, REGION)
					@formHelpers.lineInput(desc, COUNTRY_CODE)
					@formHelpers.lineInput(desc, EMAIL)
					@formHelpers.lineInput(desc, TELEPHONE)
					@formHelpers.lineInput(desc, FAX)
					@formHelpers.lineInput(desc, URL)
				}
			</fieldset>		
				
		  	<fieldset id="content-area">
				<legend>@Messages("Description")</legend>
				@defining(desc("description")) { desc =>
					@formHelpers.textInput(desc, HISTORY)
					@formHelpers.textInput(desc, GENERAL_CONTEXT)
					@formHelpers.textInput(desc, MANDATES)
					@formHelpers.textInput(desc, ADMINISTRATIVE_STRUCTURE)				  
					@formHelpers.textInput(desc, RECORDS)
					@formHelpers.textInput(desc, BUILDINGS)
					@formHelpers.textInput(desc, HOLDINGS)
					@formHelpers.textInput(desc, FINDING_AIDS)
				}
			</fieldset>				

		}
		
		<fieldset id="admin-area">
				<legend>@Messages("Administration")</legend>
				@formHelpers.enumChoiceInput(f("publicationStatus"), defines.PublicationStatus, "Publication Status")
			</fieldset>
		
		<div class="form-actions">
			<button type="submit" class="btn btn-primary">@Messages(item.map(s => "Update").getOrElse("Create"))</button>
		</div>
	}
}
